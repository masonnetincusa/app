<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Flappy Bird</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { width:100%; height:100%; background:#000; color:#fff; font-family:Arial,sans-serif; overflow:hidden; }
    button { background:red; color:#fff; border:none; padding:10px 20px; font-size:16px; cursor:pointer; }
    #background { position:absolute; top:0; left:0; width:100%; height:100%; background:#000; }
    canvas { position:absolute; top:0; left:0; width:100%; height:100%; }
    #title { position:absolute; top:20px; left:50%; transform:translateX(-50%); z-index:2; }
    #score { position:absolute; top:100px; left:50%; transform:translateX(-50%); font-size:32px; z-index:2; }
    #startBtn { position:absolute; top:160px; left:50%; transform:translateX(-50%); z-index:2; }
  </style>
</head>
<body>

  <!-- Title Image -->
  <img id="title" src="https://app.masonnet.org/fbrc.png" alt="Flappy Bird" />

  <!-- Score Display -->
  <div id="score">0</div>

  <!-- Start Button -->
  <button id="startBtn">Start</button>

  <!-- Canvas for Game -->
  <div id="background"></div>
  <canvas id="canvas"></canvas>

  <script>
    // Asset URLs
    const BIRD_IMG = 'https://app.masonnet.org/bird.png';
    const PIPE_IMG = 'https://app.masonnet.org/pipe-green.png';
    const FLAP_SND = 'https://app.masonnet.org/flap.mp3';
    const HIT_SND  = 'https://app.masonnet.org/hit.mp3';
    const DIE_SND  = 'https://app.masonnet.org/die.mp3';
    const POINT_SND= 'https://app.masonnet.org/point.mp3';

    // Canvas setup
    const canvas = document.getElementById('canvas'),
          ctx    = canvas.getContext('2d');
    function resize(){ canvas.width=innerWidth; canvas.height=innerHeight; }
    window.addEventListener('resize', resize);
    resize();

    // Load assets
    const birdImg = new Image(), pipeImg = new Image();
    birdImg.src = BIRD_IMG; pipeImg.src = PIPE_IMG;
    const flapS = new Audio(FLAP_SND),
          hitS  = new Audio(HIT_SND),
          dieS  = new Audio(DIE_SND),
          pointS= new Audio(POINT_SND);

    // Game state
    let state='menu', bird, pipes, score, frame, raf;
    const gravity=0.25, flapPower=-6, speed=2;

    class Bird {
      constructor(){ this.x=50; this.y=canvas.height/2; this.vy=0; this.w=34; this.h=24; }
      flap(){ this.vy=flapPower; flapS.play().catch(()=>{}); }
      update(){
        this.vy += gravity; this.y+=this.vy;
        if(this.y<0) this.y=0;
        if(this.y+this.h>canvas.height) this.die();
      }
      draw(){ ctx.drawImage(birdImg, this.x, this.y, this.w, this.h); }
      collides(p){
        return !(this.x+this.w<p.x || this.x>p.x+p.w || this.y+this.h<p.top || this.y>p.bottom);
      }
      die(){ if(state!=='playing') return; state='ended'; cancelAnimationFrame(raf); hitS.play().catch(()=>{}); hitS.onended=()=>dieS.play().catch(()=>{}); }
    }

    function spawnPipe(){
      const gap=120, top=20+Math.random()*(canvas.height-gap-40);
      pipes.push({ x:canvas.width, w:60, top, bottom:top+gap, passed:false });
    }

    function loop(){
      if(state!=='playing') return;
      raf=requestAnimationFrame(loop); frame++;
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // Pipes
      pipes.forEach((p,i)=>{
        p.x -= speed;
        ctx.drawImage(pipeImg,p.x,0,p.w,p.top);
        ctx.drawImage(pipeImg,p.x,p.bottom,p.w,canvas.height-p.bottom);
        if(!p.passed && bird.x>p.x+p.w){p.passed=true;score++; pointS.play().catch(()=>{});}
        if(bird.collides(p)) bird.die();
        if(p.x+p.w<0) pipes.splice(i,1);
      });

      // Bird
      bird.update(); bird.draw();

      // Spawn
      if(frame%150===0) spawnPipe();

      // Score
      document.getElementById('score').textContent = score;
    }

    function startGame(){
      bird = new Bird();
      pipes = [];
      score = 0;
      frame = 0;
      state = 'playing';
      document.getElementById('startBtn').style.display = 'none';
      loop();
    }

    // Input
    document.getElementById('startBtn').addEventListener('click', startGame);
    canvas.addEventListener('mousedown', ()=>{ if(state==='playing') bird.flap(); });
    canvas.addEventListener('touchstart',e=>{ e.preventDefault(); if(state==='playing') bird.flap(); });

  </script>
</body>
</html>
