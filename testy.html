<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Flappy Bird Hub</title>
  <link rel="icon" href="https://app.masonnet.org/fbrc.png" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #70c5ce;
      overflow: hidden;
      font-family: sans-serif;
    }

    /* Game canvas */
    #gameCanvas {
      display: block;
      margin: 0 auto;
      background: #70c5ce;
    }

    /* Full-screen overlay, fully centered */
    #gameOverOverlay {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 280px;
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      text-align: center;
      display: none;
      z-index: 1000;
    }

    #gameOverOverlay h2 {
      margin: 0 0 10px;
      font-size: 1.4em;
      color: #333;
    }

    #scoreTable {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
    }

    #scoreTable th,
    #scoreTable td {
      border-bottom: 1px solid #ccc;
      padding: 6px 4px;
    }

    #scoreTable th {
      font-weight: bold;
      color: #555;
    }

    #restartBtn {
      padding: 8px 16px;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1em;
    }

    #restartBtn:hover {
      background: #43a047;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="320" height="480"></canvas>

  <div id="gameOverOverlay">
    <h2>High Scores</h2>
    <table id="scoreTable">
      <thead>
        <tr><th>Player</th><th>Score</th></tr>
      </thead>
      <tbody></tbody>
    </table>
    <button id="restartBtn">Restart</button>
  </div>

  <script>
    // Canvas setup
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Bird parameters
    const bird = {
      x: 60,
      y: canvas.height / 2,
      radius: 12,
      gravity: 0.6,
      lift: -12,
      velocity: 0
    };

    // Pipes
    const pipes = [];
    const pipeWidth = 40;
    const gap = 120;
    let frameCount = 0;

    // Game state
    let score = 0;
    let bestScores = [
      { name: "MASONNETthisisreal", score: 124 },
      { name: "mdawg", score: 27 },
      { name: "V2Stableoutnow!", score: 25 },
      { name: "Mason Duckart", score: 21 },
      { name: "V2.1testing", score: 19 },
      { name: "Wheredacashat", score: 17 },
      { name: "LilWayne222", score: 15 },
      { name: "Whatsupgang", score: 15 },
      { name: "CARTERII", score: 14 },
      { name: "Admin", score: 14 }
    ];
    let gameOverFlag = false;

    // Input handlers
    window.addEventListener('keydown', e => {
      if (e.code === 'Space') jump();
    });

    window.addEventListener('mousedown', jump);

    function jump() {
      if (!gameOverFlag) bird.velocity = bird.lift;
    }

    // Spawn new pipes
    function spawnPipe() {
      const topHeight = Math.random() * (canvas.height - gap - 80) + 20;
      pipes.push({
        x: canvas.width,
        top: topHeight,
        bottom: canvas.height - topHeight - gap
      });
    }

    // Collision check
    function checkCollision(pipe) {
      // Bird inside horizontal pipe range?
      if (
        bird.x + bird.radius > pipe.x &&
        bird.x - bird.radius < pipe.x + pipeWidth
      ) {
        // Colliding with top or bottom
        if (
          bird.y - bird.radius < pipe.top ||
          bird.y + bird.radius > canvas.height - pipe.bottom
        ) return true;
      }
      return false;
    }

    // Render loop
    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw bird
      ctx.fillStyle = '#ff0';
      ctx.beginPath();
      ctx.arc(bird.x, bird.y, bird.radius, 0, Math.PI * 2);
      ctx.fill();

      // Draw pipes
      ctx.fillStyle = '#2ecc71';
      pipes.forEach(pipe => {
        // top pipe
        ctx.fillRect(pipe.x, 0, pipeWidth, pipe.top);
        // bottom pipe
        ctx.fillRect(
          pipe.x,
          canvas.height - pipe.bottom,
          pipeWidth,
          pipe.bottom
        );
      });

      // Draw score
      ctx.fillStyle = '#fff';
      ctx.font = '24px sans-serif';
      ctx.fillText(score, canvas.width - 50, 30);
    }

    // Update physics and state
    function update() {
      bird.velocity += bird.gravity;
      bird.y += bird.velocity;

      // Ground & ceiling
      if (bird.y + bird.radius > canvas.height || bird.y - bird.radius < 0) {
        triggerGameOver();
      }

      // Pipes logic
      pipes.forEach((pipe, i) => {
        pipe.x -= 2;

        // Score increment
        if (pipe.x + pipeWidth === bird.x) {
          score++;
        }

        // Remove off-screen pipes
        if (pipe.x + pipeWidth < 0) pipes.splice(i, 1);

        // Collision
        if (checkCollision(pipe)) triggerGameOver();
      });

      // Spawn pipes every 90 frames
      if (frameCount % 90 === 0) spawnPipe();
      frameCount++;
    }

    // Main game loop
    function loop() {
      if (!gameOverFlag) {
        update();
        draw();
        requestAnimationFrame(loop);
      }
    }

    // Game over handler
    function triggerGameOver() {
      gameOverFlag = true;
      showOverlay();
    }

    // Populate & show overlay
    function showOverlay() {
      const tbody = document.querySelector('#scoreTable tbody');
      tbody.innerHTML = '';
      bestScores.forEach(entry => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${entry.name}</td><td>${entry.score}</td>`;
        tbody.appendChild(tr);
      });

      document.getElementById('gameOverOverlay').style.display = 'block';
    }

    // Restart the game
    document.getElementById('restartBtn').onclick = () => {
      // Reset state
      bird.y = canvas.height / 2;
      bird.velocity = 0;
      pipes.length = 0;
      score = 0;
      frameCount = 0;
      gameOverFlag = false;
      document.getElementById('gameOverOverlay').style.display = 'none';

      // Restart loop
      requestAnimationFrame(loop);
    };

    // Kick off the game
    requestAnimationFrame(loop);
  </script>
</body>
</html>
