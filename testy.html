<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Flappy Bird Hub – Main Menu</title>
  <style>
    /* Reset & base */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: sans-serif; overflow: hidden; background: #fff; transition: background .3s; }

    /* Theme toggles */
    body.dark { background: #111; color: #eee; }

    /* Fullscreen container */
    #app {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      width: 100vw; height: 100vh; position: relative;
      animation: fadeIn 0.6s ease-out;
    }

    /* Logo */
    #logo { width: 160px; margin-bottom: 32px; }

    /* Buttons */
    .btn {
      background: #28a745; color: #fff; border: none; cursor: pointer;
      padding: 12px 24px; margin: 8px 0; border-radius: 4px;
      font-size: 1.1rem; transition: background .2s, transform .1s;
    }
    .btn:hover { background: #218838; }
    .btn:active { transform: scale(0.97); }

    /* Profile & Diagnostics */
    #profile {
      display: flex; align-items: center; position: absolute; top: 16px; right: 16px;
      cursor: pointer; opacity: .9; transition: opacity .2s;
    }
    #profile:hover { opacity: 1; }
    #profile img { width: 48px; height: 48px; border-radius: 50%; margin-right: 8px; }
    #diagnostics-btn { margin-left: 16px; font-size: .9rem; }

    /* Overlay (settings & diagnostics) */
    .overlay {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.8); display: flex; flex-direction: column;
      align-items: center; justify-content: center; color: #fff;
      visibility: hidden; opacity: 0; transition: opacity .3s, visibility .3s;
    }
    .overlay.open { visibility: visible; opacity: 1; }
    .overlay .panel {
      background: #222; padding: 24px; border-radius: 6px; width: 320px;
    }
    .overlay label { display: flex; align-items: center; margin: 12px 0; }
    .overlay input[type=checkbox] { margin-right: 8px; transform: scale(1.2); }

    /* Animations */
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  </style>
</head>
<body>
  <div id="app">
    <img id="logo" src="https://app.masonnet.org/fbrc.png" alt="Flappy Bird Hub Logo" />
    <button id="start-btn" class="btn">Start Game</button>
    <button id="settings-btn" class="btn">Settings</button>
    <a href="https://app.masonnet.org/flappybirdhub" class="btn">Back to Hub</a>

    <div id="profile">
      <img src="https://app.masonnet.org/default-avatar.png" alt="User Avatar">
      <span id="username">Player1</span>
      <!-- Diagnostics toggle shown only for admins -->
      <button id="diagnostics-btn" class="btn" style="display:none;">Diagnostics</button>
    </div>
  </div>

  <!-- Settings Overlay -->
  <div id="settings-overlay" class="overlay">
    <div class="panel">
      <h2>Settings</h2>
      <label><input type="checkbox" id="toggle-sound" checked /> Sound</label>
      <label><input type="checkbox" id="toggle-dark" /> Dark Mode</label>
      <label><input type="checkbox" id="toggle-skip" /> Skip to Game Over</label>
      <button id="close-settings" class="btn">Close</button>
    </div>
  </div>

  <!-- Diagnostics Overlay -->
  <div id="diagnostics-overlay" class="overlay">
    <div class="panel">
      <h2>Diagnostics (Admin)</h2>
      <pre id="diag-log" style="max-height:200px; overflow:auto; background:#000; padding:8px;"></pre>
      <button id="close-diag" class="btn">Close</button>
    </div>
  </div>

  <script>
    (function(){
      // Mock user auth – replace with real check
      const user = { name: 'Player1', isAdmin: true };

      // Settings state
      const settings = { sound: true, darkMode: false, skipToGameOver: false };
      const app = document.getElementById('app');

      // DOM refs
      const settingsBtn = document.getElementById('settings-btn');
      const settingsOverlay = document.getElementById('settings-overlay');
      const closeSettings = document.getElementById('close-settings');
      const toggleSound = document.getElementById('toggle-sound');
      const toggleDark = document.getElementById('toggle-dark');
      const toggleSkip = document.getElementById('toggle-skip');

      const diagBtn = document.getElementById('diagnostics-btn');
      const diagOverlay = document.getElementById('diagnostics-overlay');
      const closeDiag = document.getElementById('close-diag');
      const diagLog = document.getElementById('diag-log');

      // Initialize UI
      document.getElementById('username').textContent = user.name;
      if (user.isAdmin) diagBtn.style.display = 'inline-block';

      // Event handlers
      document.getElementById('start-btn').onclick = () => {
        console.log('Starting game with settings:', settings);
        // TODO: call game.init(settings)
      };

      settingsBtn.onclick = () => settingsOverlay.classList.add('open');
      closeSettings.onclick = () => settingsOverlay.classList.remove('open');

      toggleSound.onchange = e => settings.sound = e.target.checked;
      toggleDark.onchange = e => {
        settings.darkMode = e.target.checked;
        document.body.classList.toggle('dark', settings.darkMode);
      };
      toggleSkip.onchange = e => settings.skipToGameOver = e.target.checked;

      // Diagnostics (admin only)
      diagBtn.onclick = () => {
        diagLog.textContent = 'Fetching logs…';
        // TODO: fetch real diagnostics
        setTimeout(() => {
          diagLog.textContent = JSON.stringify({ settings, uptime: Date.now() }, null, 2);
        }, 300);
        diagOverlay.classList.add('open');
      };
      closeDiag.onclick = () => diagOverlay.classList.remove('open');

      // Global click to close overlays if needed
      [settingsOverlay, diagOverlay].forEach(ov => {
        ov.addEventListener('click', e => {
          if (e.target === ov) ov.classList.remove('open');
        });
      });
    })();
  </script>
</body>
</html>
